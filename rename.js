const inArg = $arguments;

const FG = ['ğŸ‡­ğŸ‡°','ğŸ‡²ğŸ‡´','ğŸ‡¹ğŸ‡¼','ğŸ‡¯ğŸ‡µ','ğŸ‡°ğŸ‡·','ğŸ‡¸ğŸ‡¬','ğŸ‡ºğŸ‡¸','ğŸ‡¬ğŸ‡§','ğŸ‡«ğŸ‡·','ğŸ‡©ğŸ‡ª','ğŸ‡¦ğŸ‡º','ğŸ‡¦ğŸ‡ª','ğŸ‡¦ğŸ‡«','ğŸ‡¦ğŸ‡±','ğŸ‡©ğŸ‡¿','ğŸ‡¦ğŸ‡´','ğŸ‡¦ğŸ‡·','ğŸ‡¦ğŸ‡²','ğŸ‡¦ğŸ‡¹','ğŸ‡¦ğŸ‡¿','ğŸ‡§ğŸ‡­','ğŸ‡§ğŸ‡©','ğŸ‡§ğŸ‡¾','ğŸ‡§ğŸ‡ª','ğŸ‡§ğŸ‡¿','ğŸ‡§ğŸ‡¯','ğŸ‡§ğŸ‡¹','ğŸ‡§ğŸ‡´','ğŸ‡§ğŸ‡¦','ğŸ‡§ğŸ‡¼','ğŸ‡§ğŸ‡·','ğŸ‡»ğŸ‡¬','ğŸ‡§ğŸ‡³','ğŸ‡§ğŸ‡¬','ğŸ‡§ğŸ‡«','ğŸ‡§ğŸ‡®','ğŸ‡°ğŸ‡­','ğŸ‡¨ğŸ‡²','ğŸ‡¨ğŸ‡¦','ğŸ‡¨ğŸ‡»','ğŸ‡°ğŸ‡¾','ğŸ‡¨ğŸ‡«','ğŸ‡¹ğŸ‡©','ğŸ‡¨ğŸ‡±','ğŸ‡¨ğŸ‡´','ğŸ‡°ğŸ‡²','ğŸ‡¨ğŸ‡¬','ğŸ‡¨ğŸ‡©','ğŸ‡¨ğŸ‡·','ğŸ‡­ğŸ‡·','ğŸ‡¨ğŸ‡¾','ğŸ‡¨ğŸ‡¿','ğŸ‡©ğŸ‡°','ğŸ‡©ğŸ‡¯','ğŸ‡©ğŸ‡´','ğŸ‡ªğŸ‡¨','ğŸ‡ªğŸ‡¬','ğŸ‡¸ğŸ‡»','ğŸ‡¬ğŸ‡¶','ğŸ‡ªğŸ‡·','ğŸ‡ªğŸ‡ª','ğŸ‡ªğŸ‡¹','ğŸ‡«ğŸ‡¯','ğŸ‡«ğŸ‡®','ğŸ‡¬ğŸ‡¦','ğŸ‡¬ğŸ‡²','ğŸ‡¬ğŸ‡ª','ğŸ‡¬ğŸ‡­','ğŸ‡¬ğŸ‡·','ğŸ‡¬ğŸ‡±','ğŸ‡¬ğŸ‡¹','ğŸ‡¬ğŸ‡³','ğŸ‡¬ğŸ‡¾','ğŸ‡­ğŸ‡¹','ğŸ‡­ğŸ‡³','ğŸ‡­ğŸ‡º','ğŸ‡®ğŸ‡¸','ğŸ‡®ğŸ‡³','ğŸ‡®ğŸ‡©','ğŸ‡®ğŸ‡·','ğŸ‡®ğŸ‡¶','ğŸ‡®ğŸ‡ª','ğŸ‡®ğŸ‡²','ğŸ‡®ğŸ‡±','ğŸ‡®ğŸ‡¹','ğŸ‡¨ğŸ‡®','ğŸ‡¯ğŸ‡²','ğŸ‡¯ğŸ‡´','ğŸ‡°ğŸ‡¿','ğŸ‡°ğŸ‡ª','ğŸ‡°ğŸ‡¼','ğŸ‡°ğŸ‡¬','ğŸ‡±ğŸ‡¦','ğŸ‡±ğŸ‡»','ğŸ‡±ğŸ‡§','ğŸ‡±ğŸ‡¸','ğŸ‡±ğŸ‡·','ğŸ‡±ğŸ‡¾','ğŸ‡±ğŸ‡¹','ğŸ‡±ğŸ‡º','ğŸ‡²ğŸ‡°','ğŸ‡²ğŸ‡¬','ğŸ‡²ğŸ‡¼','ğŸ‡²ğŸ‡¾','ğŸ‡²ğŸ‡»','ğŸ‡²ğŸ‡±','ğŸ‡²ğŸ‡¹','ğŸ‡²ğŸ‡·','ğŸ‡²ğŸ‡º','ğŸ‡²ğŸ‡½','ğŸ‡²ğŸ‡©','ğŸ‡²ğŸ‡¨','ğŸ‡²ğŸ‡³','ğŸ‡²ğŸ‡ª','ğŸ‡²ğŸ‡¦','ğŸ‡²ğŸ‡¿','ğŸ‡²ğŸ‡²','ğŸ‡³ğŸ‡¦','ğŸ‡³ğŸ‡µ','ğŸ‡³ğŸ‡±','ğŸ‡³ğŸ‡¿','ğŸ‡³ğŸ‡®','ğŸ‡³ğŸ‡ª','ğŸ‡³ğŸ‡¬','ğŸ‡°ğŸ‡µ','ğŸ‡³ğŸ‡´','ğŸ‡´ğŸ‡²','ğŸ‡µğŸ‡°','ğŸ‡µğŸ‡¦','ğŸ‡µğŸ‡¾','ğŸ‡µğŸ‡ª','ğŸ‡µğŸ‡­','ğŸ‡µğŸ‡¹','ğŸ‡µğŸ‡·','ğŸ‡¶ğŸ‡¦','ğŸ‡·ğŸ‡´','ğŸ‡·ğŸ‡º','ğŸ‡·ğŸ‡¼','ğŸ‡¸ğŸ‡²','ğŸ‡¸ğŸ‡¦','ğŸ‡¸ğŸ‡³','ğŸ‡·ğŸ‡¸','ğŸ‡¸ğŸ‡±','ğŸ‡¸ğŸ‡°','ğŸ‡¸ğŸ‡®','ğŸ‡¸ğŸ‡´','ğŸ‡¿ğŸ‡¦','ğŸ‡ªğŸ‡¸','ğŸ‡±ğŸ‡°','ğŸ‡¸ğŸ‡©','ğŸ‡¸ğŸ‡·','ğŸ‡¸ğŸ‡¿','ğŸ‡¸ğŸ‡ª','ğŸ‡¨ğŸ‡­','ğŸ‡¸ğŸ‡¾','ğŸ‡¹ğŸ‡¯','ğŸ‡¹ğŸ‡¿','ğŸ‡¹ğŸ‡­','ğŸ‡¹ğŸ‡¬','ğŸ‡¹ğŸ‡´','ğŸ‡¹ğŸ‡¹','ğŸ‡¹ğŸ‡³','ğŸ‡¹ğŸ‡·','ğŸ‡¹ğŸ‡²','ğŸ‡»ğŸ‡®','ğŸ‡ºğŸ‡¬','ğŸ‡ºğŸ‡¦','ğŸ‡ºğŸ‡¾','ğŸ‡ºğŸ‡¿','ğŸ‡»ğŸ‡ª','ğŸ‡»ğŸ‡³','ğŸ‡¾ğŸ‡ª','ğŸ‡¿ğŸ‡²','ğŸ‡¿ğŸ‡¼','ğŸ‡¦ğŸ‡©','ğŸ‡·ğŸ‡ª','ğŸ‡µğŸ‡±','ğŸ‡¬ğŸ‡º','ğŸ‡»ğŸ‡¦','ğŸ‡±ğŸ‡®','ğŸ‡¨ğŸ‡¼','ğŸ‡¸ğŸ‡¨','ğŸ‡¦ğŸ‡¶','ğŸ‡¬ğŸ‡®','ğŸ‡¨ğŸ‡º','ğŸ‡«ğŸ‡´','ğŸ‡¦ğŸ‡½','ğŸ‡§ğŸ‡²','ğŸ‡¹ğŸ‡±'];
const EN = ['HKG','MAC','TPE','JPN','KOR','SGP','USA','GBR','FRA','DEU','AUS','ARE','AFG','ALB','DZA','AGO','ARG','ARM','AUT','AZE','BHR','BGD','BLR','BEL','BLZ','BEN','BTN','BOL','BIH','BWA','BRA','VGB','BRN','BGR','BFA','BDI','KHM','CMR','CAN','CPV','CYM','CAF','TCD','CHL','COL','COM','COG','COD','CRI','HRV','CYP','CZE','DNK','DJI','DOM','ECU','EGY','SLV','GNQ','ERI','EST','ETH','FJI','FIN','GAB','GMB','GEO','GHA','GRC','GRL','GTM','GIN','GUY','HTI','HND','HUN','ISL','IND','IDN','IRN','IRQ','IRL','IMN','ISR','ITA','CIV','JAM','JOR','KAZ','KEN','KWT','KGZ','LAO','LVA','LBN','LSO','LBR','LBY','LTU','LUX','MKD','MDG','MWI','MYS','MDV','MLI','MLT','MRT','MUS','MEX','MDA','MCO','MNG','MNE','MAR','MOZ','MMR','NAM','NPL','NLD','NZL','NIC','NER','NGA','PRK','NOR','OMN','PAK','PAN','PRY','PER','PHL','PRT','PRI','QAT','ROU','RUS','RWA','SMR','SAU','SEN','SRB','SLE','SVK','SVN','SOM','ZAF','ESP','LKA','SDN','SUR','SWZ','SWE','CHE','SYR','TJK','TZA','THA','TGO','TON','TTO','TUN','TUR','TKM','VIR','UGA','UKR','URY','UZB','VEN','VNM','YEM','ZMB','ZWE','AND','REU','POL','GUM','VAT','LIE','CUW','SYC','ATA','GIB','CUB','FRO','ALA','BMU','TLS'];
const ZH = ['é¦™æ¸¯','æ¾³é—¨','å°æ¹¾','æ—¥æœ¬','éŸ©å›½','æ–°åŠ å¡','ç¾å›½','è‹±å›½','æ³•å›½','å¾·å›½','æ¾³å¤§åˆ©äºš','é˜¿è”é…‹','é˜¿å¯Œæ±—','é˜¿å°”å·´å°¼äºš','é˜¿å°”åŠåˆ©äºš','å®‰å“¥æ‹‰','é˜¿æ ¹å»·','äºšç¾å°¼äºš','å¥¥åœ°åˆ©','é˜¿å¡æ‹œç–†','å·´æ—','å­ŸåŠ æ‹‰å›½','ç™½ä¿„ç½—æ–¯','æ¯”åˆ©æ—¶','ä¼¯åˆ©å…¹','è´å®','ä¸ä¸¹','ç»åˆ©ç»´äºš','æ³¢æ–¯å°¼äºšå’Œé»‘å¡å“¥ç»´é‚£','åšèŒ¨ç“¦çº³','å·´è¥¿','è‹±å±ç»´äº¬ç¾¤å²›','æ–‡è±','ä¿åŠ åˆ©äºš','å¸ƒåŸºçº³æ³•ç´¢','å¸ƒéš†è¿ª','æŸ¬åŸ”å¯¨','å–€éº¦éš†','åŠ æ‹¿å¤§','ä½›å¾—è§’','å¼€æ›¼ç¾¤å²›','ä¸­éå…±å’Œå›½','ä¹å¾—','æ™ºåˆ©','å“¥ä¼¦æ¯”äºš','ç§‘æ‘©ç½—','åˆšæœ(å¸ƒ)','åˆšæœ(é‡‘)','å“¥æ–¯è¾¾é»åŠ ','å…‹ç½—åœ°äºš','å¡æµ¦è·¯æ–¯','æ·å…‹','ä¸¹éº¦','å‰å¸ƒæ','å¤šç±³å°¼åŠ å…±å’Œå›½','å„ç“œå¤šå°”','åŸƒåŠ','è¨å°”ç“¦å¤š','èµ¤é“å‡ å†…äºš','å„ç«‹ç‰¹é‡Œäºš','çˆ±æ²™å°¼äºš','åŸƒå¡ä¿„æ¯”äºš','æ–æµ','èŠ¬å…°','åŠ è“¬','å†ˆæ¯”äºš','æ ¼é²å‰äºš','åŠ çº³','å¸Œè…Š','æ ¼é™µå…°','å±åœ°é©¬æ‹‰','å‡ å†…äºš','åœ­äºšé‚£','æµ·åœ°','æ´ªéƒ½æ‹‰æ–¯','åŒˆç‰™åˆ©','å†°å²›','å°åº¦','å°å°¼','ä¼Šæœ—','ä¼Šæ‹‰å…‹','çˆ±å°”å…°','é©¬æ©å²›','ä»¥è‰²åˆ—','æ„å¤§åˆ©','ç§‘ç‰¹è¿ªç“¦','ç‰™ä¹°åŠ ','çº¦æ—¦','å“ˆè¨å…‹æ–¯å¦','è‚¯å°¼äºš','ç§‘å¨ç‰¹','å‰å°”å‰æ–¯æ–¯å¦','è€æŒ','æ‹‰è„±ç»´äºš','é»å·´å«©','è±ç´¢æ‰˜','åˆ©æ¯”é‡Œäºš','åˆ©æ¯”äºš','ç«‹é™¶å®›','å¢æ£®å ¡','é©¬å…¶é¡¿','é©¬è¾¾åŠ æ–¯åŠ ','é©¬æ‹‰ç»´','é©¬æ¥','é©¬å°”ä»£å¤«','é©¬é‡Œ','é©¬è€³ä»–','æ¯›åˆ©å¡”å°¼äºš','æ¯›é‡Œæ±‚æ–¯','å¢¨è¥¿å“¥','æ‘©å°”å¤šç“¦','æ‘©çº³å“¥','è’™å¤','é»‘å±±å…±å’Œå›½','æ‘©æ´›å“¥','è«æ¡‘æ¯”å…‹','ç¼…ç”¸','çº³ç±³æ¯”äºš','å°¼æ³Šå°”','è·å…°','æ–°è¥¿å…°','å°¼åŠ æ‹‰ç“œ','å°¼æ—¥å°”','å°¼æ—¥åˆ©äºš','æœé²œ','æŒªå¨','é˜¿æ›¼','å·´åŸºæ–¯å¦','å·´æ‹¿é©¬','å·´æ‹‰åœ­','ç§˜é²','è²å¾‹å®¾','è‘¡è„ç‰™','æ³¢å¤šé»å„','å¡å¡”å°”','ç½—é©¬å°¼äºš','ä¿„ç½—æ–¯','å¢æ—ºè¾¾','åœ£é©¬åŠ›è¯º','æ²™ç‰¹é˜¿æ‹‰ä¼¯','å¡å†…åŠ å°”','å¡å°”ç»´äºš','å¡æ‹‰åˆ©æ˜‚','æ–¯æ´›ä¼å…‹','æ–¯æ´›æ–‡å°¼äºš','ç´¢é©¬é‡Œ','å—é','è¥¿ç­ç‰™','æ–¯é‡Œå…°å¡','è‹ä¸¹','è‹é‡Œå—','æ–¯å¨å£«å…°','ç‘å…¸','ç‘å£«','å™åˆ©äºš','å¡”å‰å…‹æ–¯å¦','å¦æ¡‘å°¼äºš','æ³°å›½','å¤šå“¥','æ±¤åŠ ','ç‰¹ç«‹å°¼è¾¾å’Œå¤šå·´å“¥','çªå°¼æ–¯','åœŸè€³å…¶','åœŸåº“æ›¼æ–¯å¦','ç¾å±ç»´å°”äº¬ç¾¤å²›','ä¹Œå¹²è¾¾','ä¹Œå…‹å…°','ä¹Œæ‹‰åœ­','ä¹Œå…¹åˆ«å…‹æ–¯å¦','å§”å†…ç‘æ‹‰','è¶Šå—','ä¹Ÿé—¨','èµæ¯”äºš','æ´¥å·´å¸ƒéŸ¦','å®‰é“å°”','ç•™å°¼æ±ª','æ³¢å…°','å…³å²›','æ¢µè’‚å†ˆ','åˆ—æ”¯æ•¦å£«ç™»','åº“æ‹‰ç´¢','å¡èˆŒå°”','å—æ','ç›´å¸ƒç½—é™€','å¤å·´','æ³•ç½—ç¾¤å²›','å¥¥å…°ç¾¤å²›','ç™¾æ…•è¾¾','ä¸œå¸æ±¶'];

// éœ€è¦æ’é™¤çš„å…³é”®è¯
const excludeKeywords = [
    /åˆ†å‰²/, /ä½™é¢/, /ç¾¤/, /åˆ°æœŸ/, /å‰©ä½™/, /é‡ç½®/, /å¥—é¤/, /å®˜ç½‘/, /10x/, 
    /ç½‘å€/, /ç½‘ç«™/, /å……å€¼/, /æ›´æ–°/, /åœ°å€/, /å›½å†…/, /æ°¸ä¹…/, /æ•™å­¦/, /com/, /www/, /69/, /è´­ä¹°/
];

// å…³é”®è¯å¯¹åº”å¤‡æ³¨
const remarkKeywords = [
    { key: /é«˜é€Ÿ/, value: "HS" },
    { key: /ä½é€Ÿ/, value: "LS" },
    { key: /ä¸“çº¿/, value: "DL" },
    { key: /è§£é”|æµåª’ä½“/, value: "Strm" } // ç»Ÿä¸€å¤„ç†ï¼Œé¿å…é‡å¤
];

// é¢å¤–å¤‡æ³¨å…³é”®è¯
const extraRemarks = [
    { key: /æµ‹è¯•|Test/i, value: "Test" },
    { key: /Unmetered|æ— é™æµé‡/i, value: "UnLD" },
    { key: /EMBY/i, value: "Emby" },
    { key: /ç¦ä¸‹è½½|No Download/i, value: "BDl" },
    { key: /ç¦è§†é¢‘|No Video/i, value: "BVd" },
    { key: /å¯é•¿æœŸä¸‹è½½/i, value: "ADl" }
];

// **æœåŠ¡å™¨æä¾›å•†åˆ—è¡¨**
const serverProviders = [
    "AWS", "Google Cloud", "Azure", "Alibaba Cloud", "Tencent Cloud", "Cloudflare", "Oracle Cloud",
    "Linode", "Vultr", "DigitalOcean", "Hetzner", "OVH", "Contabo", "LeaseWeb", "G-Core", "StackPath",
    "Fastly", "Akamai", "CloudFront", "BunnyCDN"
];

// **é¢„å®šä¹‰åŸå¸‚åˆ—è¡¨ï¼ˆä¿®æ­£åŒ¹é…é—®é¢˜ï¼‰**
const cityList = [
    "ä¸œäº¬", "å¤§é˜ª", "åå¤å±‹", "ç¦å†ˆ", "æœ­å¹Œ", "æ¨ªæ»¨", "ç¥æˆ·", "å¹¿å²›", "ä»™å°",  
"é¦–å°”", "é‡œå±±", "ä»å·", "å¤§é‚±",  
"æ´›æ‰çŸ¶", "çº½çº¦", "èŠåŠ å“¥", "è¾¾æ‹‰æ–¯", "ç¡…è°·", "åœ£ä½•å¡", "åœ£åœ°äºšå“¥", "æ³¢å£«é¡¿",  
    "åç››é¡¿", "è¿ˆé˜¿å¯†", "è¥¿é›…å›¾", "äºšç‰¹å…°å¤§", "è´¹åŸ", "ä¼‘æ–¯æ•¦", "æ‹‰æ–¯ç»´åŠ æ–¯",  
    "å¥¥æ–¯æ±€", "ä¸¹ä½›", "åº•ç‰¹å¾‹", "å‡¤å‡°åŸ", "æ˜å°¼é˜¿æ³¢åˆ©æ–¯", "åœ£è·¯æ˜“æ–¯", "æ³¢ç‰¹å…°",  
    "åœ£å®‰ä¸œå°¼å¥¥", "å¥¥å…°å¤š", "å¤æ´›ç‰¹", "åŒ¹å…¹å ¡", "å·´å°”çš„æ‘©", "çº³ä»€ç»´å°”", "å ªè¨æ–¯åŸ",  
    "å“¥ä¼¦å¸ƒ", "å°ç¬¬å®‰çº³æ³¢åˆ©æ–¯", "æ–°å¥¥å°”è‰¯", "ç›æ¹–åŸ", "å¦å¸•", "åœ£åœ°äºšå“¥", "è¨å…‹æ‹‰é—¨æ‰˜",  
    "è¾›è¾›é‚£æ", "å…‹åˆ©å¤«å…°", "å¯†å°”æ²ƒåŸº", "è·¯æ˜“æ–¯ç»´å°”",  
"å¤šä¼¦å¤š", "æ¸©å“¥å", "è’™ç‰¹åˆ©å°”",  
"ä¼¦æ•¦", "ä¼¯æ˜ç¿°", "æ›¼å½»æ–¯ç‰¹", "çˆ±ä¸å ¡",  
"å·´é»", "é©¬èµ›", "é‡Œæ˜‚", "æ³¢å°”å¤š",  
"æ³•å…°å…‹ç¦", "æŸæ—", "æ±‰å ¡", "æ…•å°¼é»‘", "æœå¡å°”å¤šå¤«", "ç§‘éš†",  
"é˜¿å§†æ–¯ç‰¹ä¸¹", "é¹¿ç‰¹ä¸¹",  
"é©¬å¾·é‡Œ", "å·´å¡ç½—é‚£", "ç“¦ä¼¦è¥¿äºš",  
"ç½—é©¬", "ç±³å…°", "é‚£ä¸å‹’æ–¯",  
"æ‚‰å°¼", "å¢¨å°”æœ¬", "å¸ƒé‡Œæ–¯ç­", "ç€æ–¯",  
"æ–°åŠ å¡", "å°åŒ—", "é«˜é›„",  
"æ›¼è°·", "æ¸…è¿ˆ", "æ™®å‰",  
"å‰éš†å¡", "æ§ŸåŸ",  
"èƒ¡å¿—æ˜å¸‚", "æ²³å†…", "å²˜æ¸¯",  
"é›…åŠ è¾¾", "æ³—æ°´", "ä¸‡éš†",  
"è¿ªæ‹œ", "é˜¿å¸ƒæ‰æ¯”",  
"ä¼Šæ–¯å¦å¸ƒå°”", "å®‰å¡æ‹‰",  
"å¢¨è¥¿å“¥åŸ", "ç“œè¾¾æ‹‰å“ˆæ‹‰", "è’™ç‰¹é›·",  
"åœ£ä¿ç½—", "é‡Œçº¦çƒ­å†…å¢", "å¸ƒå®œè¯ºæ–¯è‰¾åˆ©æ–¯", "åœ£åœ°äºšå“¥"
];

// **ä¿®æ­£åŸå¸‚åŒ¹é…é€»è¾‘**
function findCity(name) {
    return cityList.find(city => {
        let regex = new RegExp(`\\b${city}\\b`, "i"); // ç¡®ä¿æ˜¯å®Œæ•´è¯
        return regex.test(name);
    });
}

function renameNodes(proxies) {
    let processedNodes = [];
    let countryGroups = {}; // æŒ‰å›½å®¶åˆ†ç»„å­˜å‚¨èŠ‚ç‚¹

    proxies.forEach((node) => {
        let name = node.name;

        // 1. è¿‡æ»¤åŒ…å«æ’é™¤å…³é”®è¯çš„èŠ‚ç‚¹
        if (excludeKeywords.some(regex => regex.test(name))) {
            return; // ç›´æ¥è·³è¿‡è¯¥èŠ‚ç‚¹
        }

        let country = "", flag = "", countryCode = "", countryCN = "";

        // 2. è¯†åˆ«å›½å®¶
        for (let i = 0; i < ZH.length; i++) {
            if (name.includes(ZH[i]) || name.includes(EN[i]) || name.includes(FG[i])) {
                country = ZH[i];
                countryCN = ZH[i];
                flag = FG[i];
                countryCode = EN[i];
                break;
            }
        }

        // 3. å¦‚æœæ— æ³•è¯†åˆ«å›½å®¶ï¼Œè®¾ä¸ºâ€œæœªçŸ¥â€
        if (!country) {
            flag = "ğŸŒ";
            countryCN = "æœªçŸ¥";
            countryCode = "Unknown";
        }

        // 4. è¯†åˆ«èŠ‚ç‚¹ç±»å‹
        let type = "AirP";
        if (/è‡ªå»º/.test(name)) type = "ZiJian";
        else if (/åˆç§Ÿ/.test(name)) type = "Hezu";

        // 5. è¯†åˆ«å¤‡æ³¨ä¿¡æ¯
        let remarks = [];

        // 5.1 åŸæœ‰å¤‡æ³¨åŒ¹é…
        extraRemarks.forEach(({ key, value }) => {
            if (key.test(name)) {
                remarks.push(value);
            }
        });

        // 5.2 å…³é”®è¯å¤‡æ³¨åŒ¹é…
        remarkKeywords.forEach(({ key, value }) => {
            if (key.test(name) && !remarks.includes(value)) {
                remarks.push(value);
            }
        });

        // 5.3 é¢å¤–å¤‡æ³¨ï¼šå®½å¸¦å¤§å°ï¼ˆå¦‚ 100Mbpsã€1Gbpsï¼‰
        let bandwidthMatch = name.match(/(\d+(\.\d+)?[MG]bps)/i);
        if (bandwidthMatch) {
            remarks.push(bandwidthMatch[1]);
        }

        // 5.4 **åŒ¹é…æœåŠ¡å™¨æä¾›å•†**
        let providerMatch = serverProviders.find(provider => name.includes(provider));
        if (providerMatch) {
            remarks.push(providerMatch);
        }

        // 5.5 **åŒ¹é…åŸå¸‚åˆ—è¡¨ï¼ˆä¿®æ­£è¯¯åŒ¹é…ï¼‰**
        let cityMatch = findCity(name);
        if (cityMatch) {
            remarks.push(cityMatch);
        }

        // 6. è¯†åˆ«å€ç‡
        let multiplier = "1.0x";
        let multiplierMatch = name.match(/(?<!\d)(\d+(\.\d+)?)\s?[xXå€](?!\w)/);
        if (multiplierMatch) {
            multiplier = multiplierMatch[1] + "x";
        }

        // 7. ç»„åˆæœ€ç»ˆåç§°
        let finalName = `${flag} ${countryCN} ${countryCode} ${type}`;
        if (remarks.length > 0) finalName += ` ${remarks.join(" ")}`;
        finalName += ` - ${multiplier}`;

        // 8. æŒ‰å›½å®¶åˆ†ç»„å­˜å‚¨
        if (!countryGroups[countryCode]) {
            countryGroups[countryCode] = [];
        }
        countryGroups[countryCode].push({ name: finalName, originalNode: node });
    });

    // 9. æŒ‰å›½å®¶æ’åºç¼–å·
    Object.keys(countryGroups).forEach(countryCode => {
        // æŒ‰åç§°é•¿åº¦æ’åºï¼ŒçŸ­çš„æ’å‰
        countryGroups[countryCode].sort((a, b) => a.name.length - b.name.length);

        // é‡æ–°ç¼–å·
        countryGroups[countryCode].forEach((nodeData, index) => {
            let nodeNumber = String(index + 1).padStart(2, "0"); // ç¼–å·æ ¼å¼ 01, 02, ...
            nodeData.originalNode.name = `${nodeData.name.replace(" -", ` ${nodeNumber} -`)}`; // æ’å…¥ç¼–å·
            processedNodes.push(nodeData.originalNode);
        });
    });

    return processedNodes;
}

// å¤„ç†èŠ‚ç‚¹
const updatedNodes = renameNodes(proxies);
return updatedNodes;
